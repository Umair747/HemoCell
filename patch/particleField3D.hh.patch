43c43
<         Array<T,3> const& particlePos, Box3D box ) const
---
>         T iX, T iY, T iZ, Box3D box ) const
46,48c46,48
<     T x = particlePos[0]-location.x;
<     T y = particlePos[1]-location.y;
<     T z = particlePos[2]-location.z;
---
>     T x = iX-location.x;
>     T y = iY-location.y;
>     T z = iZ-location.z;
663a664,665
>     Array<T,3> pos; 
>     pos = particle->getPosition();
665c667
<         this->isContained(particle->getPosition(), finalDomain) )
---
>         this->isContained(pos[0],pos[1],pos[2], finalDomain) )
677a680
>     Array<T,3> pos; 
681c684,685
<             if (this->isContained(particles[i]->getPosition(),finalDomain)) {
---
>             pos = particles[i]->getPosition();
>             if (this->isContained(pos[0],pos[1],pos[2],finalDomain)) {
697a702
>         Array<T,3> pos; 
699c704,705
<             if (this->isContained(particles[i]->getPosition(),finalDomain) &&
---
>             pos = particles[i]->getPosition();
>             if (this->isContained(pos[0],pos[1],pos[2],finalDomain) &&
717a724
>     Array<T,3> pos; 
719c726,727
<         if (this->isContained(particles[i]->getPosition(),domain)) {
---
>         pos = particles[i]->getPosition();
>         if (this->isContained(pos[0],pos[1],pos[2],domain)) {
730a739,740
>     Array<T,3> pos; 
>         
732c742,743
<         if (this->isContained(particles[i]->getPosition(),domain)) {
---
>         pos = particles[i]->getPosition();
>         if (this->isContained(pos[0],pos[1],pos[2],domain)) {
744a756
>       Array<T,3> pos;
746c758,759
<             if (this->isContained(particles[i]->getPosition(),finalDomain)) {
---
> 	  pos = particles[i]->getPosition();
> 	  if (this->isContained(pos[0],pos[1],pos[2],finalDomain)) {
759a773
>       Array<T,3> pos;
761c775,776
<             if (this->isContained(particles[i]->getPosition(),finalDomain)) {
---
> 	  pos = particles[i]->getPosition();
> 	  if (this->isContained(pos[0],pos[1],pos[2],finalDomain)) {
774a790
>         Array<T,3> pos;
776c792,793
<             if (this->isContained(particles[i]->getPosition(),finalDomain)) {
---
>             pos = particles[i]->getPosition();
>             if (this->isContained(pos[0],pos[1],pos[2],finalDomain)) {
788a806
>         Array<T,3> pos; 
791c809,810
<             if (this->isContained(particle->getPosition(),finalDomain)) {
---
>             pos = particle->getPosition();
>             if (this->isContained(pos[0],pos[1],pos[2],finalDomain)) {
793a813
>                 pos = particle->getPosition();
795c815
<                      (!this->isContained(particle->getPosition(),this->getBoundingBox()))  )
---
>                      (!this->isContained(pos[0],pos[1],pos[2],this->getBoundingBox()))  )
