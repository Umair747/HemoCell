42a43,56
>         T iX, T iY, T iZ, Box3D box ) const
> {
>     Dot3D const& location = this->getLocation();
>     T x = iX-location.x;
>     T y = iY-location.y;
>     T z = iZ-location.z;
> 
>     return (x > (T)box.x0-(T)0.5) && (x <= (T)box.x1+(T)0.5) &&
>            (y > (T)box.y0-(T)0.5) && (y <= (T)box.y1+(T)0.5) &&
>            (z > (T)box.z0-(T)0.5) && (z <= (T)box.z1+(T)0.5);
> }
> 
> template<typename T, template<typename U> class Descriptor>
> bool ParticleField3D<T,Descriptor>::isContained (
663a678,679
>     Array<T,3> pos; 
>     pos = particle->getPosition();
665c681
<         this->isContained(particle->getPosition(), finalDomain) )
---
>         this->isContained(pos[0],pos[1],pos[2], finalDomain) )
677a694
>     Array<T,3> pos; 
681c698,699
<             if (this->isContained(particles[i]->getPosition(),finalDomain)) {
---
>             pos = particles[i]->getPosition();
>             if (this->isContained(pos[0],pos[1],pos[2],finalDomain)) {
697a716
>         Array<T,3> pos; 
699c718,719
<             if (this->isContained(particles[i]->getPosition(),finalDomain) &&
---
>             pos = particles[i]->getPosition();
>             if (this->isContained(pos[0],pos[1],pos[2],finalDomain) &&
717a738
>     Array<T,3> pos; 
719c740,741
<         if (this->isContained(particles[i]->getPosition(),domain)) {
---
>         pos = particles[i]->getPosition();
>         if (this->isContained(pos[0],pos[1],pos[2],domain)) {
730a753,754
>     Array<T,3> pos; 
>         
732c756,757
<         if (this->isContained(particles[i]->getPosition(),domain)) {
---
>         pos = particles[i]->getPosition();
>         if (this->isContained(pos[0],pos[1],pos[2],domain)) {
744a770
>       Array<T,3> pos;
746c772,773
<             if (this->isContained(particles[i]->getPosition(),finalDomain)) {
---
> 	  pos = particles[i]->getPosition();
> 	  if (this->isContained(pos[0],pos[1],pos[2],finalDomain)) {
759a787
>       Array<T,3> pos;
761c789,790
<             if (this->isContained(particles[i]->getPosition(),finalDomain)) {
---
> 	  pos = particles[i]->getPosition();
> 	  if (this->isContained(pos[0],pos[1],pos[2],finalDomain)) {
774a804
>         Array<T,3> pos;
776c806,807
<             if (this->isContained(particles[i]->getPosition(),finalDomain)) {
---
>             pos = particles[i]->getPosition();
>             if (this->isContained(pos[0],pos[1],pos[2],finalDomain)) {
788a820
>         Array<T,3> pos; 
791c823,824
<             if (this->isContained(particle->getPosition(),finalDomain)) {
---
>             pos = particle->getPosition();
>             if (this->isContained(pos[0],pos[1],pos[2],finalDomain)) {
793a827
>                 pos = particle->getPosition();
795c829
<                      (!this->isContained(particle->getPosition(),this->getBoundingBox()))  )
---
>                      (!this->isContained(pos[0],pos[1],pos[2],this->getBoundingBox()))  )
